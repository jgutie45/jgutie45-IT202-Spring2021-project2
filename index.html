<!DOCTYPE html>

<html>

  <head>
    <meta charset="utf-8">
    <meta name = "viewport" content = "width=device-width">
    <title>Project 2</title>

    <style>
    </style>

  </head>

  <body>
      <canvas></canvas>

    <script>
        let img = new Image();
        img.src = "scottpilgrim_run.png"

        let myAudio = new Audio("Scott_Pilgrim_Anthem.mp3");

        let c = document.querySelector("canvas");

        c.style.backgroundColor = "#4D3A81";
        c.width = 500;
        c.height = 500;
        let ctx = c.getContext("2d");
        let x = -15; 
        let y = 370;

        //ctx.fillStyle = "#784284";
        //ctx.fillStyle = "blue";
        //ctx.beginPath();
        //ctx.moveTo(108, 0.0);
        //ctx.lineTo(141, 70);
        //ctx.lineTo(218, 78.3);
        //ctx.lineTo(162, 131);
        //ctx.lineTo(175, 205);
        //ctx.lineTo(108, 170);
        //ctx.lineTo(41.2, 205);
        //ctx.lineTo(55, 131);
        //ctx.lineTo(1, 78);
        //ctx.lineTo(75, 68);
        //ctx.lineTo(108, 0);
        //ctx.closePath();
        //ctx.fill();
      
      // CTRL + ALT + DOWN KEY/UP KEY

      img.addEventListener("load", (event) =>{
        //spirteH = img.height;
        //spriteW = spirteH;

        spirteH = img.height+9;
        spriteW = spirteH-33;

        ctx.drawImage(img, 0, 0, spriteW, spirteH, 0, 50, spriteW, spirteH);
        ctx.drawImage(img, spriteW*1, 0, spriteW, spirteH, 300, 50, spriteW, spirteH);

        console.log("done with drawImage");

        draw();
      });

        let numImages = 8; 
        let currentImageIndex = 0;
        let frames = 0; 

        let draw = () =>{
          // clear the canvas
          ctx.clearRect(0,0,c.width,c.height);
          //ctx.fillStyle = "#784284";
          //ctx.fillStyle = "blue";
          //ctx.beginPath();
          //ctx.moveTo(108, 0.0);
          //ctx.lineTo(141, 70);
          //ctx.lineTo(218, 78.3);
          //ctx.lineTo(162, 131);
          //ctx.lineTo(175, 205);
          //ctx.lineTo(108, 170);
          //ctx.lineTo(41.2, 205);
          //ctx.lineTo(55, 131);
          //ctx.lineTo(1, 78);
          //ctx.lineTo(75, 68);
          //ctx.lineTo(108, 0);
          //ctx.closePath();
          //ctx.fill();
          
          // calculate and update vars
          frames += 1;
          //x += 1;
          //y += 1;

          if(x % 100 == 0){
              myAudio.play();
          }

          // render
          if(frames % 15 == 0){
              
            // Calculate and update
            // Expression will execute if current image index equals zero 
            // Or keep adding the currentImage Index until it reaches the maximum
            currentImageIndex = (currentImageIndex == 7) ? 0 : currentImageIndex += 1;          
          }

          ctx.drawImage(img, spriteW*currentImageIndex, 0, spriteW, spirteH, x, y, spriteW, spirteH);
          window.requestAnimationFrame(draw);
        }

        const MOVEMENT_SPEED = 15;
        const MOVEMENT_SPEED2 = 30;

        document.addEventListener("keydown", (event) => {
          // // Keyup
          // if(event.keyCode == 38 || event.keyCode == 87){
          //  y -= MOVEMENT_SPEED;
          // }
          // // Keydown
          // else if(event.keyCode == 40 || event.keyCode == 83){
          //   y += MOVEMENT_SPEED;
          // }
          // y = 350; 



          //console.log(y);
          // Key left: Left Arrow Key and A key
          //if(event.keyCode == 39 || event.keyCode == 68){
          //  x += MOVEMENT_SPEED;
          //}
          //// Key Right: Right Arrow Key and D key
          //else if(event.keyCode == 37 || event.keyCode == 65)
          //{
          //  x -= MOVEMENT_SPEED;
          //}
          function outOfBounds(x){
            if(x < -15){
                x = 0;
              }
              else if(x >= 500){
                x = -15;
            }
          } 


          switch(event.keyCode){
            //UP Keys LISTED FIRST
            // Left Arrow Key
            case 39:
              if(x >= 405){
                x += -15;
              }
              else{
                x+= MOVEMENT_SPEED;
              }
              
              console.log("Pressed Right Arrow Key");
              console.log(x);
              break;

            case 68:
              if(x < -15){
                x = 0;
              }
              else if(x >= 500){
                x = -15;
              }
              else{
                x+= MOVEMENT_SPEED;
              }
              console.log("Pressed D Key");
              break;

            case 37:
              if(x < -15){
                x = 0;
              }
              else if(x >= 500){
                x = -15;
              }
              else{
                x-= MOVEMENT_SPEED;
              }
              console.log("Pressed Left Arrow Key");
              break;
          
            case 65:
              if(x < -15){
                x = 0;
              }
              else if(x >= 500){
                x = 499;
              }
              else{
                x-= MOVEMENT_SPEED;
              }
            console.log("Pressed A Key");
            break;

            case 32: 
            if(y == 370){
              y -= MOVEMENT_SPEED2;
            }
            console.log("Pressed Spacebar Key");
            break;

            default:
              console.log("pressed a key that is not assigned anything...");
                        // Making sure player does not exceed bounds of the canvas
              if(x < -15){
                x = 0;
              }
              else if(x >= 500){
                x = -15;
              }

          }  
          //console.log(event);

        });

        document.addEventListener("keyup", (event) => {
            // Jumping Spacebar key
            if(event.keyCode == 32){
              if(y == 340){
                y += MOVEMENT_SPEED2;
              }
              console.log(y);

            } 

        });

    </script>

    <script>

    </script>

  </body>

</html>